
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Anonymous Functions vs. Closures - dh.blog</title>
  <meta name="author" content="Dan Horrigan">

  
  <meta name="description" content="Ever wonder what the difference between an Anonymous Function and a Closure is? What about a Lambda? How are they implemented in PHP? There seems to &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dhorrigan.github.com/blog/2012/08/11/anonymous-functions-vs-closures/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="dh.blog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">dh.blog</a></h1>
  
    <h2>Rants, Code, and Everything Else</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dhorrigan.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Anonymous Functions vs. Closures</h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-08-11T00:00:00-04:00" pubdate data-updated="true">Aug 11<span>th</span>, 2012</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Ever wonder what the difference between an Anonymous Function and a Closure is?  What about a Lambda?  How are they implemented in PHP?  There seems to be a lot of confusion in this area, with people interchanging the words, and not really knowing what they mean, so lets dive in and answer these questions.</p>

<p>First things first: A &#8220;Lambda&#8221; is just another name for an Anonymous Function.  You may have seen it used in some programming language (e.g. Python) and not known what it was&#8230;now you do.</p>

<p>Now that the easy stuff is out of the way, lets take a look at what these two things <em>actually are</em>.  If you are confused at first, don&#8217;t worry, I will hopefully clear it up for you in a bit, these are just brief definitions of the two.</p>

<p><strong>Anonymous Function</strong> - An Anonymous Function is a function that is defined, and occasionally invoked, without being bound to an identifier.  It also has the variable scoping characteristics of a Closure (see below).</p>

<p><strong>Closure</strong> - A Closure is a function that captures the current containing scope, then provides access to that scope when the Closure is invoked.  The Closure binds non-local variable references to the corresponding variables in scope at the time the Closure is created.</p>

<p>From this we can derive: All Anonymous Functions are Closures, but not all Closures are Anonymous Functions.</p>

<h3>Layman&#8217;s Terms</h3>

<p>An Anonymous Function is a Closure without a name.  A Closure is a function which binds references to non-local variables to local variables inside the function at the time of the Closure definition.</p>

<h3>JavaScript Examples</h3>

<p>Here a few examples written in JavaScript (I used JS here since most people have experience in using is):</p>

<p><strong>Anonymous Function as Callback</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">getPosts</span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Code to fetch posts would go here...</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">callback</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="nx">getPosts</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">posts</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Do something with the posts here</span>
</span><span class='line'><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>Closure as Return Value</strong></p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="kd">function</span> <span class="nx">getProcessor</span><span class="p">(</span><span class="nx">driver</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// Do some magic to load the processing driver here...</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// Imagine we set the driver variable to the</span>
</span><span class='line'>    <span class="c1">// processing driver object here...</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">return</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Notice we have access to the driver var. from the</span>
</span><span class='line'>        <span class="c1">// getProcessor() scope.</span>
</span><span class='line'>        <span class="k">return</span> <span class="nx">driver</span><span class="p">.</span><span class="nx">process</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">var</span> <span class="nx">proc</span> <span class="o">=</span> <span class="nx">getProcessor</span><span class="p">(</span><span class="s1">&#39;json&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">proc</span><span class="p">(</span><span class="nx">someJsonDataHere</span><span class="p">));</span>
</span></code></pre></td></tr></table></div></figure>


<h3>How about PHP?</h3>

<p>Here is where things get interesting.  In PHP 5.3, Closures and Anonymous Functions were added to the language.  However, they have their quirks (one of which was fixed in PHP 5.4).</p>

<p>Anonymous Functions are implemented as <code>Closure</code> objects.  PHP takes the idea that &#8220;Anonymous Functions are Closures without a name&#8221; to heart, because that is EXACTLY what they are.</p>

<p>Here is a simple Anonymous Function being sent to the array_map function to multiply all integers in an array by 2 (useless, I know, but hey, it is just an example):</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="nv">$arr</span> <span class="o">=</span> <span class="nb">array_map</span><span class="p">(</span><span class="k">function</span> <span class="p">(</span><span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nb">is_int</span><span class="p">(</span><span class="nv">$val</span><span class="p">)</span> <span class="o">?</span> <span class="nv">$val</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">:</span> <span class="nv">$val</span><span class="p">;</span>
</span><span class='line'><span class="p">},</span> <span class="nv">$arr</span><span class="p">);</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p>Simple, right?  Now ask yourself this: What if you want to access non-local variables in that function?  After all Anonymous Functions are Closures too.  Well, you can, but there is a catch:  You have to explicitly tell PHP which variables it should use. That is the first of a few quirks, so let us dive into them.</p>

<h4>Quirk #1</h4>

<p>You MUST send the function all of the variables you want bound to the scope of the Closure using the <code>use</code> keyword.  This is different from most other languages, where this is done automatically (like in my JS example above).</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="nv">$foo</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$bar</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$baz</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$foo</span><span class="p">,</span> <span class="nv">$bar</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">echo</span> <span class="nv">$foo</span><span class="p">,</span> <span class="nv">$bar</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<h4>Quirk #2</h4>

<p>The bound variables are <strong>copies</strong>, of the variable, not references.  If you want to be able to change the variable inside the Closure, you MUST send it by reference:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="nv">$foo</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</span><span class='line'><span class="nv">$bar</span> <span class="o">=</span> <span class="s1">&#39;bar&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'><span class="nv">$baz</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="o">&amp;</span><span class="nv">$foo</span><span class="p">,</span> <span class="o">&amp;</span><span class="nv">$bar</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nv">$foo</span> <span class="o">=</span> <span class="s1">&#39;Hello &#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="nv">$bar</span> <span class="o">=</span> <span class="s1">&#39;World!&#39;</span><span class="p">;</span>
</span><span class='line'><span class="p">};</span>
</span><span class='line'><span class="nv">$baz</span><span class="p">();</span>
</span><span class='line'><span class="k">echo</span> <span class="nv">$foo</span><span class="p">,</span> <span class="nv">$bar</span><span class="p">;</span> <span class="c1">// Outputs &quot;Hello World!&quot;;</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<h4>Quirk #3</h4>

<p>In PHP 5.3 if you are using a Closure inside of a class, the Closure will not have access to <code>$this</code>.  You must send a reference to <code>$this</code>, however, you cannot send <code>$this</code> directly:</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="cp">&lt;?php</span>
</span><span class='line'><span class="k">class</span> <span class="nc">Test</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>    <span class="k">protected</span> <span class="nv">$foo</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">public</span> <span class="k">function</span> <span class="nf">baz</span><span class="p">()</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// Get a reference to $this</span>
</span><span class='line'>        <span class="nv">$self</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nv">$this</span><span class="p">;</span>
</span><span class='line'>        <span class="nv">$func</span> <span class="o">=</span> <span class="k">function</span> <span class="p">()</span> <span class="k">use</span> <span class="p">(</span><span class="nv">$self</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="k">echo</span> <span class="nv">$self</span><span class="o">-&gt;</span><span class="na">foo</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure>


<p><em>Note: Because of the way object references are handled in PHP, you do not have to send a reference to <code>$self</code> if you wish to modify it.</em></p>

<h3>PHP 5.4 to the Rescue</h3>

<p>In PHP 5.4, they have added support for the usage of <code>$this</code> in Closures.  They do this by binding the object to the Closure at the time of definition.</p>

<p>You can also change which object your Closure is bound to by using the <code>bind()</code> and <code>bindTo()</code> methods.  You can read more about how to use these methods and exactly what they do in the <a href="http://php.net/manual/en/class.closure.php">PHP documentation</a>.</p>

<h3>So&#8230;</h3>

<p>How should you know when to call it a Closure or Anonymous Function?  Simple:  You can always call it a Closure (because all Anonymous Functions are Closures), and if it doesn&#8217;t have a name, it is Anonymous.  Pretty simple, right?</p>

<p>Hope that helped clear up the confusion.  Feel free to leave questions in the comments, or I am always available on <a href="http://twitter.com/dhorrigan">Twitter</a>.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Dan Horrigan</span></span>

      








  


<time datetime="2012-08-11T00:00:00-04:00" pubdate data-updated="true">Aug 11<span>th</span>, 2012</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/php/'>PHP</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://dhorrigan.github.com/blog/2012/08/11/anonymous-functions-vs-closures/" data-via="dhorrigan" data-counturl="http://dhorrigan.github.com/blog/2012/08/11/anonymous-functions-vs-closures/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2012/08/09/lex-parser-2-dot-0/" title="Previous Post: Lex Parser 2.0">&laquo; Lex Parser 2.0</a>
      
      
        <a class="basic-alignment right" href="/blog/2012/08/17/simple-syntax-highlighting-for-tumblr/" title="Next Post: Simple Syntax Highlighting for Tumblr">Simple Syntax Highlighting for Tumblr &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/10/25/it-was-fun/">It was fun.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/28/is-eval-really-evil-yes-dot-dot-dot-and-no/">Is Eval Really Evil? Yes...and No.</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/17/simple-syntax-highlighting-for-tumblr/">Simple Syntax Highlighting for Tumblr</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/11/anonymous-functions-vs-closures/">Anonymous Functions vs. Closures</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/08/09/lex-parser-2-dot-0/">Lex Parser 2.0</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/dhorrigan">@dhorrigan</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'dhorrigan',
            count: 5,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("dhorrigan", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/dhorrigan" class="twitter-follow-button" data-show-count="false">Follow @dhorrigan</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Dan Horrigan -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'danhorrigan';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://dhorrigan.github.com/blog/2012/08/11/anonymous-functions-vs-closures/';
        var disqus_url = 'http://dhorrigan.github.com/blog/2012/08/11/anonymous-functions-vs-closures/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
